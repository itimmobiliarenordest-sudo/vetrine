<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Vetrine</title>
</head>
<body>

<h1>Dati vetrine</h1>

<p><strong>Totale immobili:</strong> <span id="totale">0</span></p>
<p><strong>Portogruaro:</strong> <span id="porto">0</span></p>
<p><strong>San Vito:</strong> <span id="sanvito">0</span></p>
<p><strong>Pordenone:</strong> <span id="pordenone">0</span></p>

<script>
async function caricaVetrine() {
    const res = await fetch("https://vetrine.it-immobiliarenordest.workers.dev/vetrine");
    const json = await res.json();

    if (!json.success) {
        console.error("Errore:", json.message);
        return;
    }

    const immobili = json.data;

    console.log("Immobili trovati:", immobili.length);

    document.getElementById("totale").textContent = immobili.length;

    // esempio conteggio per agenzia
    const perAgenzia = {};

    immobili.forEach(i => {
        perAgenzia[i.agenzia] = (perAgenzia[i.agenzia] || 0) + 1;
    });

    document.getElementById("porto").textContent = perAgenzia["portogruaro"] || 0;
    document.getElementById("sanvito").textContent = perAgenzia["sanvito"] || 0;
    document.getElementById("pordenone").textContent = perAgenzia["pordenone"] || 0;
}

caricaVetrine();
</script>

</body>
</html>
