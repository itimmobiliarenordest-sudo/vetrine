<script>
async function caricaVetrine() {
    const res = await fetch("https://vetrine.it-immobiliarenordest.workers.dev/vetrine");
    const json = await res.json();

    if (!json.success) {
        console.error("Errore:", json.message);
        return;
    }

    const immobili = json.data;

    console.log("Immobili trovati:", immobili.length);

    document.getElementById("totale").textContent = immobili.length;

    // esempio conteggio per agenzia
    const perAgenzia = {};

    immobili.forEach(i => {
        perAgenzia[i.agenzia] = (perAgenzia[i.agenzia] || 0) + 1;
    });

    document.getElementById("porto").textContent = perAgenzia["portogruaro"] || 0;
    document.getElementById("sanvito").textContent = perAgenzia["sanvito"] || 0;
    document.getElementById("pordenone").textContent = perAgenzia["pordenone"] || 0;
}

caricaVetrine();
</script>
